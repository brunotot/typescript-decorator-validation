import {
  require_react
} from "./chunk-BZN7XFWI.js";
import {
  require_dist
} from "./chunk-BR2J63QI.js";
import {
  __commonJS
} from "./chunk-76J2PTFD.js";

// node_modules/tdv-react/dist/src/hooks/useValidation.js
var require_useValidation = __commonJS({
  "node_modules/tdv-react/dist/src/hooks/useValidation.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var react_1 = require_react();
    var tdv_core_1 = require_dist();
    function useValidation({ defaultValue, model, groups = [] }) {
      const processor = (0, react_1.useMemo)(() => new tdv_core_1.EntityProcessor(model, ...groups), []);
      const [form, setForm] = (0, react_1.useState)(defaultValue !== null && defaultValue !== void 0 ? defaultValue : processor.noArgsInstance);
      const payload = form;
      const [detailedErrors, setDetailedErrors] = (0, react_1.useState)({});
      const [errors, setErrors] = (0, react_1.useState)({});
      const isValid = processor.isValid(payload);
      (0, react_1.useEffect)(() => {
        setDetailedErrors(processor.getDetailedErrors(payload));
        setErrors(processor.getErrors(payload));
      }, [form]);
      return {
        isValid,
        form,
        setForm,
        errors,
        detailedErrors,
        processor
      };
    }
    exports.default = useValidation;
  }
});

// node_modules/tdv-react/dist/src/contexts/FormContext.js
var require_FormContext = __commonJS({
  "node_modules/tdv-react/dist/src/contexts/FormContext.js"(exports) {
    "use strict";
    var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {
      if (k2 === void 0)
        k2 = k;
      var desc = Object.getOwnPropertyDescriptor(m, k);
      if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
        desc = { enumerable: true, get: function() {
          return m[k];
        } };
      }
      Object.defineProperty(o, k2, desc);
    } : function(o, m, k, k2) {
      if (k2 === void 0)
        k2 = k;
      o[k2] = m[k];
    });
    var __setModuleDefault = exports && exports.__setModuleDefault || (Object.create ? function(o, v) {
      Object.defineProperty(o, "default", { enumerable: true, value: v });
    } : function(o, v) {
      o["default"] = v;
    });
    var __importStar = exports && exports.__importStar || function(mod) {
      if (mod && mod.__esModule)
        return mod;
      var result = {};
      if (mod != null) {
        for (var k in mod)
          if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k))
            __createBinding(result, mod, k);
      }
      __setModuleDefault(result, mod);
      return result;
    };
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.FormContext = void 0;
    var react_1 = __importStar(require_react());
    exports.FormContext = (0, react_1.createContext)(void 0);
    function FormProvider({ children, submitted, setSubmitted, validateImmediately }) {
      return react_1.default.createElement(exports.FormContext.Provider, { value: { submitted, setSubmitted, validateImmediately } }, children);
    }
    exports.default = FormProvider;
  }
});

// node_modules/tdv-react/dist/src/hooks/useEffectWhenMounted.js
var require_useEffectWhenMounted = __commonJS({
  "node_modules/tdv-react/dist/src/hooks/useEffectWhenMounted.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var react_1 = require_react();
    function useEffectWhenMounted(fn, deps) {
      const [mounted, setMounted] = (0, react_1.useState)(deps.length === 0);
      (0, react_1.useEffect)(() => {
        setMounted(true);
      }, []);
      (0, react_1.useEffect)(() => {
        if (mounted) {
          fn();
        }
      }, deps);
    }
    exports.default = useEffectWhenMounted;
  }
});

// node_modules/tdv-react/dist/src/hooks/useForm.js
var require_useForm = __commonJS({
  "node_modules/tdv-react/dist/src/hooks/useForm.js"(exports) {
    "use strict";
    var __awaiter = exports && exports.__awaiter || function(thisArg, _arguments, P, generator) {
      function adopt(value) {
        return value instanceof P ? value : new P(function(resolve) {
          resolve(value);
        });
      }
      return new (P || (P = Promise))(function(resolve, reject) {
        function fulfilled(value) {
          try {
            step(generator.next(value));
          } catch (e) {
            reject(e);
          }
        }
        function rejected(value) {
          try {
            step(generator["throw"](value));
          } catch (e) {
            reject(e);
          }
        }
        function step(result) {
          result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);
        }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
      });
    };
    var __importDefault = exports && exports.__importDefault || function(mod) {
      return mod && mod.__esModule ? mod : { "default": mod };
    };
    Object.defineProperty(exports, "__esModule", { value: true });
    var react_1 = require_react();
    var tdv_react_1 = require_dist2();
    var FormContext_1 = require_FormContext();
    var useEffectWhenMounted_1 = __importDefault(require_useEffectWhenMounted());
    function useForm(model, config) {
      var _a, _b, _c;
      const defaultValue0 = config === null || config === void 0 ? void 0 : config.defaultValue;
      const whenChanged = (_a = config === null || config === void 0 ? void 0 : config.whenChanged) !== null && _a !== void 0 ? _a : () => {
      };
      const groups = (_b = config === null || config === void 0 ? void 0 : config.validationGroups) !== null && _b !== void 0 ? _b : [];
      const onSubmitParam = (_c = config === null || config === void 0 ? void 0 : config.onSubmit) !== null && _c !== void 0 ? _c : () => __awaiter(this, void 0, void 0, function* () {
      });
      const validateImmediatelyParam = (config === null || config === void 0 ? void 0 : config.validateImmediately) === void 0 ? false : config === null || config === void 0 ? void 0 : config.validateImmediately;
      const standalone = (config === null || config === void 0 ? void 0 : config.standalone) === void 0 ? true : config.standalone;
      const onSubmitValidationFail = config === null || config === void 0 ? void 0 : config.onSubmitValidationFail;
      const noArgsConstructedInstance = (0, react_1.useMemo)(() => new model(), []);
      const defaultValue = defaultValue0 !== null && defaultValue0 !== void 0 ? defaultValue0 : noArgsConstructedInstance;
      const ctx = (0, react_1.useContext)(FormContext_1.FormContext);
      const initialSubmitted = !standalone && !!ctx && ctx.submitted;
      const validateImmediately = standalone ? validateImmediatelyParam : ctx ? ctx.validateImmediately : validateImmediatelyParam;
      const [submitted0, setSubmitted] = (0, react_1.useState)(initialSubmitted);
      const submitted = validateImmediately || submitted0;
      const { form, setForm, errors: errors0, isValid, processor } = (0, tdv_react_1.useValidation)({
        model,
        defaultValue,
        groups
      });
      const [errors, setErrors] = (0, react_1.useState)(errors0);
      const dispatchContext = (bool) => {
        if (!standalone && !!ctx) {
          ctx === null || ctx === void 0 ? void 0 : ctx.setSubmitted(!!bool);
        }
      };
      const handleSetSubmitted = (bool) => {
        const value = !!bool;
        dispatchContext(value);
        setSubmitted(value);
      };
      (0, useEffectWhenMounted_1.default)(() => whenChanged(), [form]);
      (0, useEffectWhenMounted_1.default)(() => setErrors(errors0), [errors0]);
      (0, react_1.useEffect)(() => {
        const contextValue = !!(ctx === null || ctx === void 0 ? void 0 : ctx.submitted);
        const hasParentContext = !!ctx;
        if (!standalone && hasParentContext) {
          setSubmitted(contextValue);
        }
      }, [ctx === null || ctx === void 0 ? void 0 : ctx.submitted]);
      const onSubmit = () => __awaiter(this, void 0, void 0, function* () {
        handleSetSubmitted(true);
        if (!isValid) {
          const newErrors = submitted ? structuredClone(errors) : errors;
          if (submitted) {
            setErrors(newErrors);
          }
          onSubmitValidationFail === null || onSubmitValidationFail === void 0 ? void 0 : onSubmitValidationFail(newErrors);
          return;
        }
        yield onSubmitParam();
      });
      const handleChange = (0, react_1.useCallback)((key, value) => {
        setForm((prev) => {
          const obj = {};
          for (const prop of processor.fields) {
            obj[prop] = prev[prop];
          }
          obj[key] = typeof value === "function" ? value(prev[key]) : value;
          return obj;
        });
      }, [setForm]);
      const cachedHandlers = (0, react_1.useMemo)(() => processor.fields.reduce((prev, prop) => Object.assign(Object.assign({}, prev), { [prop]: (value) => handleChange(prop, value) }), {}), []);
      const providerProps = {
        submitted: submitted0,
        setSubmitted: handleSetSubmitted,
        validateImmediately
      };
      return [
        form,
        setForm,
        {
          isValid,
          isSubmitted: submitted,
          cachedHandlers,
          onSubmit,
          handleChange,
          providerProps,
          errors: validateImmediately ? errors : submitted ? errors : {}
        }
      ];
    }
    exports.default = useForm;
  }
});

// node_modules/tdv-react/dist/index.js
var require_dist2 = __commonJS({
  "node_modules/tdv-react/dist/index.js"(exports) {
    var __importDefault = exports && exports.__importDefault || function(mod) {
      return mod && mod.__esModule ? mod : { "default": mod };
    };
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.validators = exports.useValidation = exports.useForm = exports.setLocale = exports.Rule = exports.FormProvider = exports.EntityProcessor = void 0;
    var useValidation_1 = __importDefault(require_useValidation());
    exports.useValidation = useValidation_1.default;
    var tdv_core_1 = require_dist();
    Object.defineProperty(exports, "EntityProcessor", { enumerable: true, get: function() {
      return tdv_core_1.EntityProcessor;
    } });
    Object.defineProperty(exports, "Rule", { enumerable: true, get: function() {
      return tdv_core_1.Rule;
    } });
    Object.defineProperty(exports, "setLocale", { enumerable: true, get: function() {
      return tdv_core_1.setLocale;
    } });
    Object.defineProperty(exports, "validators", { enumerable: true, get: function() {
      return tdv_core_1.validators;
    } });
    var FormContext_1 = __importDefault(require_FormContext());
    exports.FormProvider = FormContext_1.default;
    var useForm_1 = __importDefault(require_useForm());
    exports.useForm = useForm_1.default;
  }
});
export default require_dist2();
//# sourceMappingURL=tdv-react.js.map
