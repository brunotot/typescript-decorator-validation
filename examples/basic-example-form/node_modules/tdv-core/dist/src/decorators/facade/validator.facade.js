"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.makeValidator = void 0;
const decorator_factory_1 = require("../decorator.factory");
function makeValidator(builder) {
    return (0, decorator_factory_1.makeDecorator)((key, processor) => {
        saveMetadata(processor, key, builder.groups, builder.isValid);
    });
}
exports.makeValidator = makeValidator;
function getSanitizedGroups(unsanitizedGroups) {
    return Array.isArray(unsanitizedGroups)
        ? unsanitizedGroups
        : unsanitizedGroups !== undefined
            ? [unsanitizedGroups]
            : [];
}
function saveMetadata(processor, key, groups, isValid) {
    const validate = processor.getValidationProcessor(key);
    validate.appendNode({
        groups: getSanitizedGroups(groups),
        validate: isValid,
    });
}
